\chapter{Appendices}

\section{Appendix: Computation of Evaluation Metrics}

In this appendix we will examine the methodologies used to compute the evaluation metrics in this paper. These are median Average Precision, Average Distance, symmetric Average Distance, and Average Distance Distribution.

\subsection{Median Average Precision (mAP)}

Object detection and 2D bounding box regression performance are both evaluated using median Average Precision (mAP). This metric exploits the intersection over union (IoU), computed as:

\begin{equation*}
    \text{IoU} = \frac{B_{GT} \cap B_{P}}{B_{GT} \cup B_{P}}
    \label{eq:IoU}
\end{equation*}

... where $B_{GT}$ is the area of the ground truth bounding box and $B_{P}$ is the area of the network's predicion. A prediction is considered true if its IoU is greater than a threshold, usually 0.5; based on this, we can generate the model's confusion matrix.

\begin{table}[ht]
    \begin{center}
        \begin{tabular}{c||c|c}
            \space & Actual Positives & Actual Negatives\\
            \hline\hline
            Predicted Positives & True Positives (TP)& False Positives (FP)\\
            \hline
            Predicted Negatives & False Negatives (FN)& True Negatives (TN)\\
        \end{tabular}
        \caption{Generation of the confusion matrix.}
    \end{center}
\end{table}

Starting from these values we can compute a model's precision and recall:

\begin{align*}
    \text{Precision (P)} &= \frac{\text{TP}}{\text{TP} + \text{FP}}\\
    \text{Recall (R)} &= \frac{\text{TP}}{\text{TP} + \text{FN}}
\end{align*}

To compute the Average Precision, we plot precision as a function of recall $P = f(R)$, for each sample. Thus the Average Precision is defined as:

\begin{equation*}
    \text{AP} = \int_{0}^{1} f(R)dR
\end{equation*}

The median Average Precision is then simply obtained as the average AP over all the object classes:

\begin{equation*}
    \text{mAP} = \frac{1}{n} \sum_{i=1}^{n} \text{AP}_{i}
\end{equation*}

\subsection{Average Distance (AD) and Average Distance Distribution (ADD)}

Average Distance is the most used metric for evaluating pose estimation methods. Given $n$ points belonging to the 3D model $M$, this metric represents the average distance between these points transformed according to the ground truth ($\text{R}, \text{t}$) and according to the prediction ($\hat{\text{R}}, \hat{\text{t}}$):

\begin{equation*}
    \text{AD} = \frac{1}{n} \sum_{x \in M} ||(\text{R}x + \text{t}) - 
    (\hat{\text{R}}x + \hat{\text{t}})||_2
\end{equation*}

The Average Distance Distribution (ADD) is then given by the percentage of correct poses given by the model. A pose is correct if its AD metric is less than 10\% of the model's diameter.

This metric runs into serious issues when dealing with symmetric objects. The reason for this is that these objects may present no visual differences with different rotations. For example, one image of the M6x30 screw we use for inferencing could correspond to six different poses, each varying 60\degree from the previous one. This means that the model recieves a large amount of false negatives, and will eventually stabilize at a value that minimizes the average error, which is ususally large.

To combat this issue, we use the Symmetric Average Distance (AD-S)\cite{PoseCNN} metric, defined as the average minimum distance between points in the predicted pose and the ground truth:

\begin{equation*}
    \text{AD-S} = \frac{1}{n} \sum_{x_1 \in M} \min_{x_2 \in M} ||(\text{R}x_2 + \text{t}) - 
    (\hat{\text{R}}x_1 + \hat{\text{t}})||_2
\end{equation*}

This is very similar to the loss used in the ICP algorithm, as it only considers the distance from each point to its closest correspodent in the ground truth. Analogously to ADD, we then implement ADD-S as the percentage of correct poses.

Finally, we can introduce the Mixed Average Distance, which is defined as:

\begin{equation*}
    \text{ADD(-S)} = 
    \begin{cases}
        \text{ADD-S} & \text{if the object is symmetric,}\\
        \text{ADD} & \text{otherwise.}
    \end{cases}
\end{equation*}